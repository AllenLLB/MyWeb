<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Header</title>
	<link rel="stylesheet" type="text/css" href="../Fcss/index.css" />
	<script type="text/javascript" src="../Fjs/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="../Fjs/Animate.js"></script>
</head>
<body>
	<div id="container">
		<div class="main">
			<div class="side-nav">
				<div class="artLists">
					<ul class="side-lists">
						<li class="li1 toIframe puzzle" data-url="../ProjectLists/拼图/index.html" data-setting='{
							"min-width":1300,
							"min-height":600
						}'>puzzle</li>
						<li class="li2 toIframe music" data-url="../ProjectLists/网易云音乐/index.html" data-setting='{
							"min-width":1010,
							"min-height":671
						}'>CloudMusic</li>
						<li class="li3 toIframe baidu" data-url="../ProjectLists/百度/index.html" data-setting='{
							"min-width":1360,
							"min-height":670
						}'>百度</li>
						<li class="li4 toIframe Painting" data-url="../ProjectLists/Painting/index.html" data-setting='{
							"min-width":1200,
							"min-height":650
						}'>Painting</li>
						<li class="li5 toIframe" data-url="general.html">dajhd</li>
						<li class="li6 toIframe" data-url="general.html">dasdhuahdu</li>
						<li class="li7 toIframe" data-url="general.html">jdiajd</li>
						<li class="li8 toIframe" data-url="general.html">huahdu</li>
					</ul>
				</div>
				<div class="menuList">
					<ul>
						<li  class="btn-menu">menu</li>
					</ul>
				</div>
			</div>
			<div class="show-win">
				<ul class="win-lists">
					<li class="li1 toIframe puzzle" data-url="../ProjectLists/拼图/index.html" data-setting='{
						"min-width":1300,
						"min-height":600
					}'></li>
					<li class="li2 toIframe music" data-url="../ProjectLists/网易云音乐/index.html" data-setting='{
						"min-width":1010,
						"min-height":671
					}'></li>
					<li class="li3 toIframe baidu" data-url="../ProjectLists/百度/index.html" data-setting='{
							"min-width":1360,
							"min-height":670
					}'></li>
					<li class="li4 toIframe Painting" data-url="../ProjectLists/Painting/index.html" data-setting='{
							"min-width":1200,
							"min-height":650
					}'>Painting</li>
					<li class="li5 toIframe" data-url="general.html">dajhd</li>
					<li class="li6 toIframe" data-url="general.html">dasdhuahdu</li>
					<li class="li7 toIframe" data-url="general.html">jdiajd</li>
					<li class="li8 toIframe" data-url="general.html">huahdu</li>
				</ul>
			</div>
		</div>
		<ul class="index-lists">
			<li class="drag li1 toIframe puzzle" data-url="../ProjectLists/拼图/index.html" data-setting='{
						"min-width":1300,
						"min-height":600
			}'>puzzle</li>
			<li class="drag li2 toIframe music" data-url="../ProjectLists/网易云音乐/index.html" data-setting='{
				"min-width":1010,
				"min-height":671
			}'></li>
			<li class="drag li3 toIframe baidu" data-url="../ProjectLists/百度/index.html" data-setting='{
							"min-width":1360,
							"min-height":670
			}'></li>
			<li class="drag li4 toIframe Painting" data-url="../ProjectLists/Painting/index.html" data-setting='{
							"min-width":1200,
							"min-height":650
			}'>Painting</li>
			<li class="drag li5 toIframe" data-url="general.html">dajhd</li>
			<li class="drag li6 toIframe" data-url="general.html">dasdhuahdu</li>
			<li class="drag li7 toIframe" data-url="general.html">jdiajd</li>
			<li class="drag li8 toIframe" data-url="general.html">huahdu</li>
		</ul>

		<div class="foot-nav">
			<ul class="nav">
				<li class="show-menu"></li>
			</ul>
		</div>
		<div class="containerWins">
			<iframe   name="containerWins" src=""></iframe>
		</div>
		<div id="canvas">
			<canvas class="clock" width="150" height="150"></canvas>
		</div>
	</div>






<script type="text/javascript">

    //先使用构造函数构造库对象
    var libo=new Libo();

    //这些变量的定义都用自执行函数,然后给window注册
    (function(){

        var args={};

        //此页面的总结构,类似于body
        args.container=document.getElementById("container");

        //五大金刚之一的底部部分
        args.footNav=libo.getByClass("foot-nav")[0];

        //五大金刚之一的应用的容器,以及所有的应用
        args.indexLists=libo.getByClass("index-lists")[0];

        args.aIndexLists=args.indexLists.getElementsByTagName("li");

        //五大金刚之一的总菜单打开是显示的菜单
        args.oMain=libo.getByClass("main")[0];

        //五大金刚之一的canvas容器以及canvas
        args.canCon=document.getElementById("canvas");
        args.can=libo.getByClass("clock")[0];

        //五大金刚之一的桌面上用来显示打开的应用的部分以及显示的框架
        args.mainWin=libo.getByClass("containerWins")[0];
        args.Tiframe=document.querySelector("iframe");

        //五大金刚之一的底部用来打开显示总菜单的总开关
        args.oBtn=libo.getByClass("show-menu")[0];
        
        //一下都是在总菜单里面显示的
        //总菜单中的左侧栏的一系列
        args.sideNav=libo.getByClass("side-nav")[0];
        args.artLists=libo.getByClass("artLists")[0];
        args.menuList=libo.getByClass("menuList")[0];
        //总菜单中的左侧栏中用来表示显示还是隐藏的按钮
        args.oBtnList=libo.getByClass("btn-menu")[0];

        //总菜单中的右侧栏的主体部分容器以及总体部分
        args.showWin=libo.getByClass("show-win")[0];
        args.winLists=libo.getByClass("win-lists")[0];

       	//所有的打开应用的开关由三部分组成
        args.ListsBtns=libo.getByClass("toIframe");
   
        

        //这个标志表示有没有案例被打开(应用)
        args.openFlag=false;

        //表示是否想要显示总按钮点开的总菜单(想的话是true)
        args.showFlag=true;	

        //表示总菜单容器中侧栏的隐藏的部分是不是显示
        args.show=false;
        

        //给window注册
        window["args"]=args;
        
    }());

    args.oBtn.onclick=showOrCloswAllList;
    // args.showWin.onclick=showOrCloswAllList;
    args.oBtnList.onclick=showOrClosMenu;
	//show??or??close

	function showOrCloswAllList(e){

		var oE=e||window.event;

		if (args.showFlag) {

			if(!args.openFlag){

				libo.css(args.oMain,"display","block");
				libo.css(args.canCon,"display","none");
				libo.startMove(args.oMain,{opacity:80},30,function(){
					libo.css(args.indexLists,"display","none");
				});

				args.showFlag=false;

			}else{
				libo.css(args.oMain,"display","block");
				libo.startMove(args.oMain,{opacity:80},30,function(){
					libo.css(args.indexLists,"display","none");
					libo.css(args.mainWin,"display","none");
				});

				args.showFlag=false;

			}
		}else{

			if(!args.openFlag){ 
				libo.css(args.indexLists,"display","block");
				libo.startMove(args.oMain,{opacity:0},30,function(){
					libo.css(args.oMain,"display","none");
					libo.css(args.canCon,"display","block");
					// mainWin.style.display="block"; //暂时不用这个
				});

				args.showFlag=true;
			}else{

				libo.startMove(args.oMain,{opacity:0},30,function(){

					libo.css(args.oMain,"display","none");
					libo.css(args.mainWin,"display","block");
				});

				args.showFlag=true;
			}

			
		}

		//同时检测menu
		if(args.show){
			var changeWidth=args.artLists.offsetWidth;
			libo.startMove(args.sideNav,{left:args.sideNav.offsetLeft-changeWidth},30,function(){
				args.oBtnList.innerHTML="menu";
			});
			libo.startMove(args.showWin,{left:args.showWin.offsetLeft-changeWidth},30);
			args.show=false;
		}

		//取消事件冒泡
		oE.cancelBubble=true;
		oE.stopPropagation();

		//取消事件捕获
	}

	//showMenu??

	function showOrClosMenu(){
		
		var changeWidth=args.artLists.offsetWidth;

		if(!args.show){
			libo.startMove(args.sideNav,{left:args.sideNav.offsetLeft+changeWidth},30,function(){
				args.oBtnList.innerHTML="back";
			});
			libo.startMove(args.showWin,{left:args.showWin.offsetLeft+changeWidth},30);
			args.show=true;
			
			
		}else{
			libo.startMove(args.sideNav,{left:args.sideNav.offsetLeft-changeWidth},30,function(){
				args.oBtnList.innerHTML="menu";
			});
			libo.startMove(args.showWin,{left:args.showWin.offsetLeft-changeWidth},30);
			args.show=false;
			
		}
		
	}

	//给index的lists进行布局转换(都自执行闭包函数)

	(function changeIndexLists(){
		for(var i=0;i<args.aIndexLists.length;i++){
			args.aIndexLists[i].style.left=args.aIndexLists[i].offsetLeft+"px";
			args.aIndexLists[i].style.top=args.aIndexLists[i].offsetTop+"px";
		}
		for(var j=0;j<args.aIndexLists.length;j++){
			args.aIndexLists[j].style.position="absolute";
			args.aIndexLists[j].style.margin="0";
		}
	}());


	//给index的lists添加拖动事件
	libo.drag(args.indexLists,args.aIndexLists);

	//自执行函数给所有的lists iframe 添加双击事件
	(function(){
		for(var i=0;i<args.ListsBtns.length;i++){
			args.ListsBtns[i].index=i;
			args.ListsBtns[i].ondblclick=function(){
				// args.indexLists.style.display="none";
				// args.mainWin.style.display="block";
				libo.css(args.indexLists,"display","none");
				libo.css(args.mainWin,"display","block");
				libo.css(args.canCon,"display","none");

				//给新的应用的窗口
				//设置在页面上父级网页上显示的位置
				var setting=this.getAttribute("data-setting");
				if(setting&&setting!==""){
					setting=$.parseJSON(setting);
					libo.css(args.Tiframe,"width",setting["min-width"]);
					libo.css(args.Tiframe,"min-width",setting["min-width"]);
					libo.css(args.Tiframe,"min-height",setting["min-height"]);
					libo.css(args.Tiframe,"height",setting["min-height"]);

					args.Tiframe.style.left="50%";
					args.Tiframe.style.top="50%";

					libo.css(args.Tiframe,"marginLeft",-setting["min-width"]/2);
					libo.css(args.Tiframe,"marginTop",-setting["min-height"]/2-1);

					args.Tiframe.style.position="absolute";
					args.mainWin.style.zIndex=6;

					//让应用的显示在桌面之上
					

				}

				args.Tiframe.src=this.getAttribute("data-url");	

				args.openFlag=true;

				//检测原始菜单是否展开
				if(!args.showFlag){
					showOrCloswAllList();
				}
			}
		}
	}());

	//画时钟模块
	(function(){
		if(args.can==null){
			//your browser do not support canvas
		}else{
			var ctx=args.can.getContext("2d");

			var w=args.can.width;
			var h=args.can.height;

			var r=w/2||h/2;

			//按照比例缩放
			var scale=w/200;




			//drawClock
			function draw(){

				var date=new Date();

				ctx.clearRect(0,0,w,h);
				var hour=date.getHours();
				var minute=date.getMinutes();
				var second=date.getSeconds();

				drawBg();
				drawAllPoint();
				drawHour(hour,minute);
				drawMinute(minute);
				drawSecond(second);
				drawPoint();

				ctx.restore();


			}
			draw();
			//定时
			setInterval(draw,1000);
			//drawBackground
			function drawBg(){

				ctx.save();			//将之前的环境保存下来
				ctx.translate(r,r);
				ctx.beginPath();
				ctx.fillStyle="transparent";
				ctx.arc(0,0,r,0,2*Math.PI,false);
				ctx.fill();

				ctx.closePath();
			}

			//drawAllPoints

			function drawAllPoint(){
				var rad;
				var x;
				var y;
				ctx.fillStyle="black";
				for(var i=0;i<60;i++){
					rad=2*Math.PI /60 *i;
					x=Math.cos(rad) * (r-5*scale);
					y=-Math.sin(rad) * (r-5*scale);
					ctx.beginPath();
					if(i%5==0){
						ctx.arc(x,y,4*scale,0,2*Math.PI,false);
						ctx.closePath();
						ctx.fill();
					}else{
						ctx.arc(x,y,2*scale,0,2*Math.PI,false);
						ctx.closePath();
						ctx.fill();
					}
					
				}
			}

			function drawHour(hour,minute){
				var rad=2 *Math.PI/ 12 *hour;
				var mrad=2 *Math.PI/ 12 /60 *minute;
				ctx.save();
				ctx.rotate(rad+mrad);

				ctx.beginPath();

				ctx.lineWidth=5*scale;

				ctx.lineCap="round";	//设置笔触
				ctx.moveTo(0,10*scale);
				ctx.lineTo(0,-r/2);

				ctx.stroke();

				ctx.closePath();
				ctx.restore();
			}

			function drawMinute(minute){
				var mrad=2 *Math.PI/ 60 *minute;
				ctx.save();
				ctx.rotate(mrad);

				ctx.beginPath();

				ctx.lineWidth=3*scale;
				ctx.moveTo(0,10*scale);
				ctx.lineTo(0,-r+20*scale);

				ctx.stroke();

				ctx.closePath();
				ctx.restore();
			}

			function drawSecond(second){
				var srad=2 *Math.PI/ 60 *second;
				ctx.save();
				ctx.rotate(srad);

				ctx.beginPath();

				ctx.fillStyle="red";

				ctx.moveTo(2*scale,10*scale);
				ctx.lineTo(-2*scale,10*scale);
				ctx.lineTo(-1*scale,-r+10*scale);
				ctx.lineTo(1*scale,-r+10*scale);

				ctx.closePath();
				ctx.fill();
				ctx.restore();
			}

			function drawPoint(){
				ctx.beginPath();

				ctx.fillStyle="#B4B4BC";

				ctx.arc(0,0,2*scale,0,2 * Math.PI,false);

				ctx.closePath();
				ctx.fill();
			}

		}
	}());

	//对钟表用一个弹性拖动运动
	(function(){

		args.canCon.onmousedown=function(e){

			var oE=e||window.event;
			//鼠标距离自身边界的位置
			var canX=oE.clientX-this.offsetLeft;
			var canY=oE.clientY-this.offsetTop;

			// document.title=canX+" "+canY;

			document.onmousemove=function(e){
				var oE=e||window.event;
				var l=oE.clientX-canX;
				var t=oE.clientY-canY;

				if(l<0){
					l=0;
				}else if(l>args.container.offsetWidth-args.canCon.offsetWidth){
					l=args.container.offsetWidth-args.canCon.offsetWidth
				}

				if(t<0){
					t=0;
				}else if(t>args.container.offsetHeight-args.canCon.offsetHeight){
					t=args.container.offsetHeight-args.canCon.offsetHeight
				}

				libo.css(args.canCon,"left",l);

				libo.css(args.canCon,"top",t);
			}

			document.onmouseup=function(){
				document.onmousemove=null;
				document.onmouseup=null;
			}

		}	

	}());
</script>
</body>
</html>